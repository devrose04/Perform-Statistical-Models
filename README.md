# Rによる統計モデリング

このプロジェクトは、時系列データに対して非線形モデルと状態空間モデルを実装するRプログラムです。

## 概要

提供されたデータセット（`WWdata.csv`）を以下の統計モデリング手法で分析します：

1. **非線形モデル**:
   - 指数モデル: Y ~ a * exp(b * X)
   - べき乗モデル: Y ~ a * X^b
   - 多変量モデル: Y ~ a * X^b * exp(c * T) * W^d

2. **状態空間モデル**:
   - 基本的なローカルレベルモデル（DLM）
   - 回帰成分を含む構造時系列モデル

## 必要条件

以下のRパッケージが必要です：
- tidyverse
- nlme
- nls2
- dlm
- forecast
- KFAS
- minpack.lm
- pacman（他のパッケージのインストールに使用）

## データ

データセット（`WWdata.csv`）には以下の変数が含まれています：
- Year(t): 時点
- Y: 応答変数
- X, T, W: 説明変数

## 使用方法

1. Rがシステムにインストールされていることを確認
2. データファイルが`assets`ディレクトリにあることを確認
3. スクリプトを実行：

```bash
Rscript 統計モデル.R
```

## 出力

スクリプトは以下の処理を行います：
1. データの読み込みと要約統計量の表示
2. `plots`ディレクトリに探索的データ可視化を生成
3. 非線形モデルのフィッティングと結果の表示
4. 状態空間モデルのフィッティングと結果の表示
5. モデル比較のためのフレームワークを提供

## ファイル

- `統計モデル.R`: 統計モデリングのメインスクリプト
- `assets/WWdata.csv`: データファイル
- `plots/`: 生成されたプロットを保存するディレクトリ

## モデルの詳細

### 非線形モデル
スクリプトは応答変数（Y）と説明変数（X, T, W）の関係を理解するために、いくつかの非線形モデルをフィッティングします。モデルの適合度はR二乗値で評価されます。

### 状態空間モデル
状態空間モデルは、dlmパッケージ（基本的なローカルレベルモデル用）とKFASパッケージ（回帰成分を含む構造時系列モデル用）の両方を使用して実装されています。これらのモデルは時系列の基礎構造を理解し、予測を行うのに役立ちます。

## モデルの比較
モデルは以下の基準で比較されます：
- 情報量基準（AIC、BIC）
- 予測精度（RMSE、MAE）
- 残差診断
- 交差検証結果 